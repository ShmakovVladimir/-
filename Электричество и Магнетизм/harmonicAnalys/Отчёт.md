# Спектральный анализ электрических сигналов
**Шмаков Владимир Б04-105**
**МФТИ - октябрь 2022**

## Цель работы
Целью данной работы является изучение спектрального состава периодических сигналов.
## Сведения об амплитудной модуляции
Рассмотрим амплитудную модуляцию на примере гармонических сигналов:
$$
f(t) = a_{0} \operatorname{cos}(w_0 t) \ \ \ \ \ \ 
a(t) = a_{0}(1+M\operatorname{cos}(\Omega t)) \tag{1}
$$
В данном случае $a_0$ - сдвиг модулирующего сигнала(*offset*). $M$ - отношение амплитуды модулирующего сигнала к его сдвигу. Этому параметру присвоено название **глубины модуляции**. 

Глубину модуляции можем выразить через максимальную и мимнимальную амплитуды результирующего сигнала:
$$
M = \frac{A_{max} - A_{min}}{A_{max}+A_{min}}
$$
В выражении (1) раскроем скобки, и воспользуемся формулой произведения косинусов. В реузльтате получим, что результат амплитудной модуляции есть сумма трёх гармоник:

![[AmpModulationHarmonies.svg | center | ]]

- $f_{carrier}(t) = a_{0} \operatorname{cos} w_{0} t$ - частота несущей гармоники совпадает с частотой несущего сигнала
- $f_{sideR}(t) = \frac{M a_{0}}{2} \operatorname{cos}(w_{0}+\Omega )t$
-  $f_{sideL}(t) = \frac{M a_{0}}{2} \operatorname{cos}(w_{0} - \Omega )t$
Заметим, что согласно полученным формулам:
$$
\frac{A_{side}}{A_{carr}} = \frac{M a_{0}}{2 a_{0}} = \frac{M}{2} \tag{2}
$$


## Спектр периодической последовательности прямоугольных импульсов
Пусть $f$ - периодическая функция: $f(t) = f(t+T) \ \ \ \forall t$. В курсе математического анализа доказывается, что:
$$
f(t) = \sum_{n=-\infty}^{\infty} c_{n}\operatorname{exp}(inw_{0}t) \ \ \ n \in Z \tag{3}
$$
При этом составляющие спектра $c_{n}$ определяются по формуле:
$$
c_{n} = \frac{1}{T} \int_{0}^{T} f(t) \operatorname{exp}(inw_{0}t) dt \tag{3.1}
$$
Теперь можем найти спектр мендра. Пусть $\tau$ - длительность импульса, $T$ - период сигнала:

![[periodicImpulse.png | center]]

Для нахождения составляющих спектра проинтегрируем выражение $(3.1)$ на интервале $[-T/2,T/2]$. Рассматриваемая функция $f$ отлична от нуля только на промежутке от $[-\tau/2,\tau/2]$. Получаем:
$$
\color{purple} c_{n} = \frac{1}{T} \int_{-\tau/2}^{\tau/2} \operatorname{exp}(inw_{0}t) dt = \frac{sin(\pi n \tau/T)}{\pi n} \tag{4}
$$

В качестве примера приведу спектр меандра со скважностью 2:

![[meandr_50.png| center| ]]
> оранжевым обозначены линии огибающей спектра

Полуширину главного максимума огибающей функции можем найти из условия $sin(w\tau / 2) = 0$. Отсюда получаем:
$$
\Delta w \tau = 2 \pi \tag{5}
$$
Данная формула называется **соотношением неопределённости**.  

## Оборудование
- Двуканальный генератор электрических сигналов
- АЦП с частотой дисретизации $48.8 \ kHz$.
- Компьютер с программой для анализа спектра
## Обработка результатов эксперимента
##### Cпектр периодической последовательности прямоугольных сигналов
Исследуем спектр периодической последовательности прямоугольных сигналов. Для этого подадим на спектрометр прямоугольный сигнал с харатеристиками:
![[experiment1_signal.svg| center]]
В результате получаем следующий спектр:

![[spectrum_1_100.png | center | ]] 

Теперь попробуем увеличить скважность сигнала вдвое. Согласно теоретической модели, ширина спектра тоже должна увеличиться. При этом частоты «пиков» спектра останутся неизменными:

![[spectrum_1_50.png | center |  ]]

Изменяя скважность сигнала (ручкой параметра $\tau$) можем наблюдать изменение ширины спектра. 

Изменим $\tau$ от $40$ до $120$ $мкс$, и запишем ширину спектра. 

По полученным данным можем проверить соотношение неопределённости $(5)$. Для этого построим график зависимости ширины спектра $\Delta \nu$ от величины, обратной длительности имупульса:

![[deltaNuByTau_1.png | center |]]

Методом наименьших квадратов вычислим наклон наилучшей кривой. Получим: $\alpha = 1.1 \pm 0.1$. 
Согласно соотношению неорпедлённости $\Delta \nu \tau = 1$. Значит *экспериментально полученное значение в пределах погрешности совпадает с табличным*. 
##### Амплитудная модуляция 
Исследуем результат амплитудной модуляции синусоидального сигнала частотой $25 \ kHz$, синусоидальным сигналом с частотой $1 \ kHz$. 

![[AmpModulation_p24.svg | center | 450]]

Посмотрим, как изменяется спектральный состав исследуемого сигнала в зависимости от глубины модуляции(глубиной модуляции позволяет управлять парметр *Ampl* первого канала генератора). 
Для каждого эксперимента рассчитаем глубну модуляции, и построим часть наблюдаемого спектра(в диапазоне от 23 до 27 килоГерц): 

![[amplitudeModulationSpectrum.png | center | ]]

По полученным данным можем проверить формулу (2). Для этого построим  график зависимости $A_{side}/A_{carr}$ от глубины модуляции $M$:

![[a_side_a_carr_by_m.png | center |]]

Наклон кривой аппроксимации получился равным $\alpha = 0.53 \pm 0.04$. При этом «табличное» значение составляет $0.5$. Значит результат эксперимента в пределах погрешности совпадает со значением теоретической модели.

##### Исследование периодической последовательности цугов
Теперь выполняем амплитудную модуляцию синусоидального сигнала частотой $30 \ kHz$ прямоугольным сигналом частотой $1 \ kHz$. В результате получим периодическую последовательность цугов:

![[tsugi.png | center]]


Спектр данного сигнала изменяется при разных значениях $f_{повт}$ - частоты прямоугольного сигнала. Рассмотрим, как изменяется расстояние между ближайшими пиками $\delta \nu$  в зависимости от $f_{повт}$:

![[tsugi_plot.png | center |]]
Коэффициент наклона наилучшей прямой оказался равным: $\alpha = 1 \pm 0.05$. Таким образом, результат совпал с теоретической моделью.
## Вывод

В работе мы ознакомились со спектральным составом периодических сигналов. А именно с прямоуголным сигналом и синусоидальным сигналом, модулированным по амплитуде. 

Помимо этого удалось экспериментально проверить частный случай соотношения неопределённости. 

## Приложение 

C рассчетами и данными можно ознакомиться в репозитории: https://github.com/ShmakovVladimir/Labs



